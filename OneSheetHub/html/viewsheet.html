<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏ã‡∏∑‡πâ‡∏≠‡∏ä‡∏µ‡∏ó | OneSheetHub</title>
  <link rel="stylesheet" href="../css/viewsheet.css" />
  <style>
    /* ‚úÖ ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏ó‡∏ö‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà */
    .cart-panel.open ~ .cart-toggle {
      opacity: 0;
      pointer-events: none;
      transform: scale(0.9);
      transition: opacity 0.3s, transform 0.3s;
    }

    .cart-toggle {
      opacity: 1;
      transition: opacity 0.3s, transform 0.3s;
    }
  </style>
</head>

<body>
  <!-- üîù Navbar -->
  <nav class="navbar">
    <div class="logo">
      <img src="../pic/logo.png" alt="OneSheetHub Logo" height="40" />
      <span>OneSheet<br />Hub</span>
    </div>
    <ul class="nav-links">  
      <li><a href="home.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
      <li><a href="viewsheet.html" class="active">‡∏ã‡∏∑‡πâ‡∏≠‡∏ä‡∏µ‡∏ó</a></li>
      <li><a href="upload.html">‡∏Ç‡∏≤‡∏¢‡∏ä‡∏µ‡∏ó</a></li>
      <li><a href="mysheet.html">‡∏ä‡∏µ‡∏ó‡∏â‡∏±‡∏ô</a></li>
      <li><a href="myprofile.html">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</a></li>
    </ul>
    <div class="user-info">
      <div
        id="emailCard"
        style="
          display: inline-flex;
          align-items: center;
          gap: 4px;
          width: 64px;
          min-height: 32px;
          transition: gap 0.3s, width 0.3s;
          position: relative;
          justify-content: center;
          background: #dac7f7;
          border-radius: 16px;
          padding: 4px 8px;
          overflow: hidden;
        "
      >
        <span class="icon" id="bellIcon" style="font-size: 20px; transition: opacity 0.3s;">&#128276;</span>
        <span class="icon" id="userIcon" style="font-size: 20px; transition: opacity 0.3s;">&#128100;</span>
        <span
          id="userEmail"
          style="
            visibility: hidden;
            opacity: 0;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            white-space: nowrap;
            background: #dac7f7;
            padding: 4px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            color: #6a1b9a;
            transition: opacity 0.3s, visibility 0.3s;
          "
          >-</span
        >
      </div>
      <button
        id="logoutBtn"
        style="
          margin-left: 12px;
          background: #e57373;
          color: #fff;
          border: none;
          border-radius: 8px;
          padding: 6px 16px;
          font-size: 14px;
          cursor: pointer;
        "
      >
        Logout
      </button>
    </div>
  </nav>

  <!-- üåü Main -->
  <main>
    <!-- üîç ‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
    <div class="search-filter">
      <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏µ‡∏ó..." />
      <select id="facultySelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ì‡∏∞</option>
        <option value="‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå">‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
        <option value="‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à">‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
        <option value="‡∏ô‡∏¥‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå">‡∏ô‡∏¥‡∏ï‡∏¥‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</option>
      </select>
      <select id="majorSelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤</option>
        <option value="‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå">‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
        <option value="‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î">‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î</option>
        <option value="‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à">‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
      </select>
      <select id="termSelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏Ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
      </select>
      <select id="yearSelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
        <option value="2565">2565</option>
        <option value="2566">2566</option>
        <option value="2567">2567</option>
        <option value="2568">2568</option>
      </select>
      <select id="subjectCodeSelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤</option>
        <option value="COMP101">COMP101</option>
        <option value="MKT201">MKT201</option>
        <option value="LAW301">LAW301</option>
      </select>
      <button id="searchBtn">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
    </div>

    <!-- üîÑ ‡πÇ‡∏´‡∏•‡∏î‡∏ä‡∏µ‡∏ó -->
    <div id="sheetLoading" style="display: flex; justify-content: center; align-items: center; margin: 32px 0;">
      <div class="spinner"></div>
    </div>

    <!-- üßæ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ä‡∏µ‡∏ó -->
    <div class="sheet-list" id="sheetList"></div>

    <!-- ‚úÖ ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ Slide-in -->
    <div id="cartPanel" class="cart-panel">
      <div class="cart-header">
        <span>üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ä‡∏µ‡∏ó</span>
        <button id="closeCart" style="background: none; border: none; font-size: 20px; cursor: pointer;">‚úï</button>
      </div>
      <div id="cartItems"></div>
      <div class="cart-footer">
        <div class="cart-total">
          <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
          <span id="cartTotal">0‡∏ø</span>
        </div>
        <button id="checkoutBtn" class="checkout-btn">‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ä‡∏µ‡∏ó‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</button>
      </div>
    </div>

    <!-- üõí ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≠‡∏¢‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ (‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏á cartPanel) -->
    <div id="cartToggle" class="cart-toggle">üõí</div>

    <script type="module" src="../js/viewsheet.js"></script>
  </main>

  <!-- üíå Hover ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏• -->
  <script>
    const emailCard = document.getElementById("emailCard");
    const userEmail = document.getElementById("userEmail");
    const bellIcon = document.getElementById("bellIcon");
    const userIcon = document.getElementById("userIcon");

    emailCard.onmouseenter = () => {
      emailCard.style.gap = "0";
      emailCard.style.width = "220px";
      bellIcon.style.opacity = "0";
      userIcon.style.opacity = "0";
      userEmail.style.visibility = "visible";
      userEmail.style.opacity = "1";
    };
    emailCard.onmouseleave = () => {
      emailCard.style.gap = "4px";
      emailCard.style.width = "64px";
      bellIcon.style.opacity = "1";
      userIcon.style.opacity = "1";
      userEmail.style.visibility = "hidden";
      userEmail.style.opacity = "0";
    };
  </script>

  <!-- üö™ Logout -->
  <script type="module">
    import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";
    const logoutBtn = document.getElementById("logoutBtn");
    if (logoutBtn) {
      logoutBtn.onclick = async () => {
        const auth = getAuth();
        await signOut(auth);
        localStorage.clear();
        window.location.href = "login.html";
      };
    }
  </script>
</body>
</html>
