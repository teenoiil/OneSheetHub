<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ชีทของฉัน | OneSheetHub</title>
  <link rel="stylesheet" href="../css/mysheet.css">
  <style>
    .sheet-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin:16px 0}
    .sheet-card{background:#e6dbff; border-radius:16px; padding:16px}
    .sheet-card .cover{width:64px;height:64px;border-radius:8px;object-fit:cover;background:#ddd}
    .section-title{margin-top:28px;margin-bottom:6px;color:#5b3cc4;font-weight:700}
    .muted{color:#888}
  </style>
</head>
<body style="background:url('../pic/wallpaper1.png') no-repeat center center fixed;background-size:cover;">
  <nav class="navbar">
    <div class="logo">
      <img src="../pic/logo.png" alt="OneSheetHub Logo" height="40">
      <span>OneSheet<br>Hub</span>
    </div>
    <ul class="nav-links">
      <li><a href="home.html">หน้าแรก</a></li>
      <li><a href="viewsheet.html">ซื้อชีท</a></li>
      <li><a href="upload.html">ขายชีท</a></li>
      <li><a href="mysheet.html" class="active">ชีทฉัน</a></li>
      <li><a href="myprofile.html">โปรไฟล์</a></li>
    </ul>
    <div class="user-info">
      <div id="emailCard" style="display:inline-flex;align-items:center;gap:4px;width:64px;min-height:32px;transition:gap .3s,width .3s;position:relative;justify-content:center;background:#dac7f7;border-radius:16px;padding:4px 8px;overflow:hidden;">
        <span class="icon" id="bellIcon" style="font-size:20px;transition:opacity .3s;">&#128276;</span>
        <span class="icon" id="userIcon" style="font-size:20px;transition:opacity .3s;">&#128100;</span>
        <span id="userEmail" style="visibility:hidden;opacity:0;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);white-space:nowrap;background:#dac7f7;padding:4px 12px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.08);color:#6a1b9a;transition:opacity .3s,visibility .3s;">-</span>
      </div>
      <button id="logoutBtn" style="margin-left:12px;background:#e57373;color:#fff;border:none;border-radius:8px;padding:6px 16px;font-size:14px;cursor:pointer;">Logout</button>
    </div>
  </nav>

  <main>
    <h2 style="text-align:center;margin-top:32px;">ชีทของฉัน</h2>

    <div id="sheetLoading" style="display:flex;justify-content:center;align-items:center;margin:24px 0;">
      <div class="spinner"></div>
    </div>

    <!-- Purchased -->
    <h3 class="section-title">Sheets I Purchased</h3>
    <div id="mysheetPurchased" class="sheet-list"></div>
    <div id="noPurchased" class="muted" style="display:none;">ยังไม่มีชีทที่ซื้อ</div>

    <!-- Uploaded -->
    <h3 class="section-title">Sheets I Uploaded</h3>
    <div id="mysheetUploaded" class="sheet-list"></div>
    <div id="noUploaded" class="muted" style="display:none;">ยังไม่มีชีทที่อัปโหลด</div>

    <div style="width:100%;text-align:center;margin:24px 0;">
      <button onclick="window.history.back()" type="button" style="background:#fff;color:#7c4dff;border:1px solid #7c4dff;border-radius:8px;padding:8px 24px;font-size:18px;cursor:pointer;">ย้อนกลับ</button>
    </div>
  </main>

  <script type="module" src="../js/mysheet.js"></script>
  <script>
    const emailCard=document.getElementById('emailCard');
    const userEmail=document.getElementById('userEmail');
    const bellIcon=document.getElementById('bellIcon');
    const userIcon=document.getElementById('userIcon');
    emailCard.onmouseenter=()=>{emailCard.style.gap='0';emailCard.style.width='220px';bellIcon.style.opacity='0';userIcon.style.opacity='0';userEmail.style.visibility='visible';userEmail.style.opacity='1';};
    emailCard.onmouseleave=()=>{emailCard.style.gap='4px';emailCard.style.width='64px';bellIcon.style.opacity='1';userIcon.style.opacity='1';userEmail.style.visibility='hidden';userEmail.style.opacity='0';};
  </script>
  <script type="module">
    import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";
    const logoutBtn=document.getElementById('logoutBtn');
    if (logoutBtn) logoutBtn.onclick=async()=>{const auth=getAuth();await signOut(auth);localStorage.clear();window.location.href='login.html';};
  </script>
</body>
</html>
